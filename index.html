<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <title>Night In</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.4.3/dist/css/foundation.min.css" integrity="sha256-GSio8qamaXapM8Fq9JYdGNTvk/dgs+cMLgPeevOYEx0= sha384-wAweiGTn38CY2DSwAaEffed6iMeflc0FMiuptanbN4J+ib+342gKGpvYRWubPd/+ sha512-QHEb6jOC8SaGTmYmGU19u2FhIfeG+t/hSacIWPpDzOp5yygnthL3JwnilM7LM1dOAbJv62R+/FICfsrKUqv4Gg==" crossorigin="anonymous">
</head>
<body>
  <div class="top-bar">
    <div class="top-bar-left">
      <ul class="dropdown menu" data-dropdown-menu>
        <li class="menu-text">Night In</li>
        <li><a href="#">One</a></li>
        <li><a href="#">Two</a></li>
        <li><a href="#">Three</a></li>
      </ul>
    </div>
    <div class="top-bar-right">
    </div>
  </div>
  <br>
  <div class="grid-x">
    <div class="cell small-3"></div>
    <div class="card small-6">
      <div class="card-divider">
        Time for a great night in!
      </div>
      <div class="card-section">
        <label>
          What do you want to eat?
          <textarea id="search-input" placeholder="Ex: Spaghetti"></textarea>
        </label>
        <br>
        <label>
          What ingredients do you have?
          <textarea id="ingredient-input" placeholder="Ex: Onions,tomato,cilantro"></textarea>
        </label>
        <div class="input-group-button">
          <input type="submit" class="button" id="submit-button" value="Submit">
        </div>
      </div>
    </div>
    <div class="cell small-3"></div>
  </div>

<br>
<div class="grid-x">
  <div class="cell small-1"></div>
  <div class="card small-5">
    <div class="card-divider">
      See the recipes.
    </div>
    <div class="card-section">
      <div id="recipes"></div>
    </div>
  </div>
  <div class="cell small-1"></div>

  <div class="card small-5">
    <div class="card-divider">
      Your movie suggestion
    </div>
    <div class="card-section">
      <div id="movie"></div>
    </div>
  </div>
  <div class="cell small-1"></div>

</div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript">
function displayRecipeInfo() {
// var query = "spaghetti";
// var ingredients ="onions";
var ingredients = $("#ingredient-input").val().trim();
// var query = $(this).attr("data-name");
var query = $("#search-input").val().trim();
var queryURL = "https://recipe-puppy.p.rapidapi.com/?p=1&i=" + ingredients + "&q=" + query
// Creating an AJAX call for the specific movie button being clicked
var settings = {
  "async": true,
  "crossDomain": true,
  "url": queryURL,
  "method": "GET",
  "headers": {
    "x-rapidapi-host": "recipe-puppy.p.rapidapi.com",
    "x-rapidapi-key": "3606c3e55cmsh29177efa7ad81c4p1104c9jsna3124ed278ee"
  }
};
// $.ajax({
//   url: queryURL,
//   method: "GET"
// }).then(function(response) {
$.ajax(settings).then(function (response) {
response = JSON.parse(response);
console.log(response);

$("#recipes").text("");

// displayRecipe();
for(var i=0; i < response.results.length; i++){
  // Creating a div to hold the recipeÃŸ
  var recipeDiv = $("<div class='recipe'>");
  var title = response.results[i].title;
  // Creating an element to have the rating displayed
  var pOne = $("<p>").text("Recipe: " + title);
  // Displaying the rating
  recipeDiv.append(pOne);
  // Storing the release year
  var link = response.results[i].href;
  // Creating an element to hold the release year
  var pTwo = $("<a>").html(link);
  pTwo.attr('href', link);
  // Displaying the release year
  recipeDiv.append(pTwo);
  // Storing the plot
  var ingredients = response.results[i].ingredients;
  // Creating an element to hold the plot
  var pThree = $("<p>").text("Ingredients: " + ingredients);
  // Appending the plot
  recipeDiv.append(pThree);
  // Retrieving the URL for the image
  var imgURL = response.results[i].thumbnail;
  // Creating an element to hold the image
  var image = $("<img>").attr("src", imgURL);
  // Appending the image
  recipeDiv.append(image);
  // Putting the entire movie above the previous movies
  var hr = $("<hr>");
  // Appending the image
  recipeDiv.append(hr);

  $("#recipes").append(recipeDiv);
}});
}

function displayMovieInfo() {

// var movie = $(this).attr("data-name");
var movie = $("#search-input").val().trim();
var queryURL = "https://www.omdbapi.com/?t=*" + movie + "*&apikey=trilogy";
// var queryURL = "http://www.omdbapi.com/?s=*" + movie + "*&apikey=trilogy"

// Creating an AJAX call for the specific movie button being clicked
$.ajax({
  url: queryURL,
  method: "GET"
}).then(function(response) {

console.log(response);
// for(var i=0; i < 5; i++){

  $("#movie").text("");


  // Creating a div to hold the movie
  var movieDiv = $("<div class='movie'>");

  var title = response.Title;

  // Creating an element to hold the release year
  var pZero = $("<p>").text("Title: " + title);

  // Displaying the release year
  movieDiv.append(pZero);

  // Storing the rating data
  var rating = response.Rated;

  // Creating an element to have the rating displayed
  var pOne = $("<p>").text("Rating: " + rating);

  // Displaying the rating
  movieDiv.append(pOne);

  // Storing the release year
  var released = response.Released;

  // Creating an element to hold the release year
  var pTwo = $("<p>").text("Released: " + released);

  // Displaying the release year
  movieDiv.append(pTwo);


  // Storing the plot
  var plot = response.Plot;

  // Creating an element to hold the plot
  var pThree = $("<p>").text("Plot: " + plot);

  // Appending the plot
  movieDiv.append(pThree);

  // Retrieving the URL for the image
  var imgURL = response.Poster;

  // Creating an element to hold the image
  var image = $("<img>").attr("src", imgURL);

  // Appending the image
  movieDiv.append(image);

  // Putting the entire movie above the previous movies
  $("#movie").prepend(movieDiv);
// }
});

}


// This function handles events where a movie button is clicked
$("#submit-button").on("click", function(event) {
event.preventDefault();
// This line grabs the input from the textbox
var recipe = $("#search-input").val().trim();
displayRecipeInfo();
displayMovieInfo();

})
</script>
<script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.4.3/dist/js/foundation.min.js" integrity="sha256-mRYlCu5EG+ouD07WxLF8v4ZAZYCA6WrmdIXyn1Bv9Vk= sha384-KzKofw4qqetd3kvuQ5AdapWPqV1ZI+CnfyfEwZQgPk8poOLWaabfgJOfmW7uI+AV sha512-0gHfaMkY+Do568TgjJC2iMAV0dQlY4NqbeZ4pr9lVUTXQzKu8qceyd6wg/3Uql9qA2+3X5NHv3IMb05wb387rA==" crossorigin="anonymous"></script>
</body>
</html>